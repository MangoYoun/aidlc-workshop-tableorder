# 테이블오더 서비스 요구사항 명세서

## Intent Analysis Summary

### 사용자 요청
테이블오더 서비스 구축 - 고객용 주문 인터페이스와 관리자용 관리 시스템을 포함한 완전한 디지털 주문 플랫폼

### 요청 유형
**New Project** - Greenfield 프로젝트

### 범위 추정
**System-wide** - 전체 시스템 구축 (Frontend, Backend, Database, 실시간 통신)

### 복잡도 추정
**Complex** - 다중 사용자 인터페이스, 실시간 통신, 세션 관리, 상태 동기화 등 복잡한 요구사항

---

## 1. 프로젝트 개요

### 1.1 서비스 비전
디지털 주문 시스템을 통해 고객에게는 편리한 주문 경험을, 매장 운영자에게는 효율적인 운영 환경을 제공하는 차세대 테이블오더 플랫폼

### 1.2 핵심 가치 제안

**고객 관점:**
- 대기 시간 없는 즉시 주문
- 직관적이고 사용하기 쉬운 인터페이스

**매장 운영자 관점:**
- 인건비 절감 및 운영 효율성 증대
- 실시간 주문 관리 및 모니터링

**시장 차별화:**
- 다양한 업종에 적용 가능한 유연한 구조
- 직관적인 관리자 도구

---

## 2. 기술 스택 및 아키텍처

### 2.1 기술 스택 결정

**Backend:**
- Framework: **FastAPI (Python)**
- 이유: 빠른 개발 속도, 자동 API 문서화, 비동기 처리 지원

**Frontend:**
- Framework: **Vue.js**
- 이유: 학습 곡선이 낮고, 반응형 UI 구현 용이

**Database:**
- RDBMS: **PostgreSQL**
- 이유: 트랜잭션 무결성, 관계형 데이터 모델 적합

**배포 환경:**
- Cloud Provider: **AWS (Amazon Web Services)**
- 예상 규모: 중소규모 매장 3-10개 (동시 사용자 10-50명)

**실시간 통신:**
- 방식: **Server-Sent Events (SSE)**
- 용도: 관리자 대시보드 실시간 주문 업데이트

### 2.2 성능 요구사항

**응답 시간:**
- API 응답: **500ms 이하**
- 실시간 주문 표시: **2초 이내**

**동시 사용자:**
- 예상: **10-50명** (중소규모 매장 3-10개)

---

## 3. 기능 요구사항

### 3.1 고객용 기능 (Customer Features)

#### 3.1.1 테이블 태블릿 자동 로그인 및 세션 관리

**목적:** 고객이 별도 로그인 절차 없이 즉시 주문할 수 있도록 자동 인증

**기능 요구사항:**
- **초기 설정 (관리자가 1회 수행):**
  - 매장 식별자 입력
  - 테이블 번호 입력
  - 테이블 비밀번호 입력
  - 최종 로그인 정보 **LocalStorage에 저장**
- **자동 로그인:**
  - 1회 로그인 성공 후, 저장된 정보로 자동 로그인
  - 브라우저 재시작 시에도 자동 로그인 유지

**세션 관리:**
- **테이블 세션 만료 정책:**
  - **16시간 고정 만료** (테이블 태블릿 로그인 시점부터)
  - **마지막 주문 후 일정 시간 경과 시 만료** (예: 2시간)
  - 둘 중 **먼저 도달하는 조건**으로 세션 자동 종료
- 세션 종료 시 자동 로그아웃 및 재로그인 필요

#### 3.1.2 메뉴 조회 및 탐색

**목적:** 고객이 매장의 메뉴를 쉽게 탐색하고 선택할 수 있도록 지원

**기능 요구사항:**
- **기본 화면:** 메뉴 화면이 기본 화면으로 항상 표시
- 카테고리별 메뉴 분류 및 표시
- 메뉴 상세 정보 표시:
  - 메뉴명
  - 가격
  - 메뉴 설명
  - 메뉴 이미지 (서버에 업로드 및 저장)
- 카테고리 간 빠른 이동

**UI/UX 요구사항:**
- 카드 형태의 메뉴 레이아웃
- 터치 친화적인 버튼 크기 (최소 44x44px)
- 명확한 시각적 계층 구조

#### 3.1.3 장바구니 관리

**목적:** 주문 전 선택한 메뉴를 임시 저장하고 수정할 수 있는 기능

**기능 요구사항:**
- 메뉴 추가/삭제
- 수량 조절 (증가/감소)
- 총 금액 실시간 계산
- 장바구니 비우기
- **LocalStorage에 저장** (페이지 새로고침 시에도 유지)

**데이터 관리:**
- 클라이언트 측 임시 저장 (LocalStorage)
- 페이지 새로고침 시에도 유지
- **테이블 세션 종료 시 자동 삭제**
- 서버 전송은 주문 확정 시에만 수행

#### 3.1.4 주문 생성

**목적:** 장바구니의 메뉴를 실제 주문으로 전환

**기능 요구사항:**
- 주문 내역 최종 확인
- 주문 확정 버튼
- **주문 성공 플로우:**
  - 주문 번호 표시
  - 장바구니 자동 비우기
  - 메뉴 화면으로 자동 리다이렉트
- 주문 실패 시 에러 메시지 표시 및 장바구니 유지

**주문 정보 포함 항목:**
- 매장 식별 정보
- 테이블 식별 정보
- 주문 메뉴 목록 (메뉴명, 수량, 단가)
- 총 주문 금액
- 세션 ID (테이블 세션 추적용)

#### 3.1.5 주문 내역 조회

**목적:** 현재 테이블의 주문 이력을 확인

**기능 요구사항:**
- 주문 시간 순 정렬
- 주문별 상세 정보 표시:
  - 주문 번호
  - 주문 시각
  - 주문 메뉴 및 수량
  - 주문 금액
  - 주문 상태 (대기중/준비중/완료)
- 주문 상태 실시간 업데이트 (선택사항)

**데이터 필터링:**
- **현재 테이블 세션 주문만 표시** (이전 식사 세션 제외)
- 매장 이용 완료 처리된 주문은 제외
- 페이지네이션 또는 무한 스크롤

---

### 3.2 관리자용 기능 (Admin Features)

#### 3.2.1 매장 인증

**목적:** 관리자가 자신의 매장 관리 시스템에 접근

**기능 요구사항:**
- 매장 식별자 입력
- 사용자명 및 비밀번호 입력
- **세션 관리:**
  - 16시간 세션 유지
  - JWT 토큰 기반 인증
  - **JWT 토큰 LocalStorage에 저장**
  - 브라우저 새로고침 시 세션 유지
  - 16시간 후 자동 로그아웃

**보안 요구사항:**
- 비밀번호 안전한 저장 (bcrypt 해싱)
- 로그인 시도 제한
- JWT 기반 인증

#### 3.2.2 실시간 주문 모니터링

**목적:** 들어오는 주문을 실시간으로 확인하고 관리

**기능 요구사항:**
- **주문 목록 실시간 업데이트** (Server-Sent Events 사용)
- **그리드/대시보드 레이아웃:**
  - 테이블별 카드 형태 표시
  - 각 테이블 카드에 총 주문액 표시
  - 최신 주문 n개 미리보기
- 주문별 상세 정보 표시:
  - 테이블 번호
  - 주문 번호
  - 주문 시각
  - 주문 메뉴 및 수량 (축약)
  - 총 금액
- **주문 카드 클릭 시:** 전체 메뉴 목록 상세 보기
- 주문 상태 변경 (대기중/준비중/완료)
- 신규 주문 시각적 강조 (색상 변경, 애니메이션)

**업데이트 방식:**
- Server-Sent Events (SSE) 기반 실시간 통신
- 2초 이내 주문 표시

**UI 요구사항:**
- 그리드 형태의 테이블별 레이아웃
- 최신 주문 강조 표시
- 테이블별 필터링 기능

#### 3.2.3 테이블 관리

**목적:** 테이블별 주문 상태 관리 및 세션 라이프사이클 관리

**기능 요구사항:**

**1. 테이블 태블릿 초기 설정:**
- 테이블 번호 및 테이블 비밀번호 설정
- 16시간 세션 생성
- 설정 정보 저장 및 자동 로그인 활성화

**2. 주문 삭제 (직권 수정):**
- 특정 주문 삭제 버튼
- 확인 팝업 표시
- 주문 즉시 삭제
- 테이블 총 주문액 재계산
- 성공/실패 피드백
- **권한:** 관리자만 가능

**3. 테이블 세션 처리:**
- 테이블 세션 시작(세션의 첫 주문) 및 종료 관리(테이블 이용 완료)
- 확인 팝업 표시
- 테이블 세션 종료(이용 완료) 시, 해당 세션의 주문 내역을 과거 이력으로 이동
- 테이블 세션 종료(이용 완료) 시, 테이블 현재 주문 목록 및 총 주문액 0으로 리셋
- 새 고객이 이전 주문 내역 없이 시작 가능
- 성공/실패 피드백
- **자동 세션 종료 조건:**
  - 16시간 고정 만료 OR
  - 마지막 주문 후 일정 시간 경과 (예: 2시간)

**4. 과거 주문 내역 조회:**
- "과거 내역" 버튼
- 테이블별 과거 주문 목록 표시 (시간 역순)
- 각 주문 정보: 주문 번호, 시각, 메뉴 목록, 총 금액, 매장 이용 완료 시각
- 날짜 필터링 기능
- "닫기" 버튼으로 대시보드 복귀

**데이터 관리:**
- 주문 이력 데이터베이스 저장 (OrderHistory 테이블)
- 세션 ID로 주문 그룹화
- 완료 시각 기록

#### 3.2.4 메뉴 관리

**목적:** 메뉴 정보를 동적으로 관리

**기능 요구사항:**
- 메뉴 조회 (카테고리별)
- 메뉴 등록:
  - 메뉴명
  - 가격
  - 설명
  - 카테고리
  - 이미지 업로드 (서버에 저장)
- 메뉴 수정
- 메뉴 삭제
- 메뉴 노출 순서 조정

**데이터 검증:**
- 필수 필드 검증
- 가격 범위 검증

---

## 4. 비기능 요구사항 (Non-Functional Requirements)

### 4.1 성능 (Performance)

**응답 시간:**
- API 응답: 500ms 이하
- 페이지 로딩: 2초 이내
- 실시간 주문 업데이트: 2초 이내

**동시 사용자:**
- 지원 규모: 10-50명 (중소규모 매장 3-10개)
- 확장 가능성: 수평 확장 가능한 아키텍처

### 4.2 보안 (Security)

**인증 및 권한:**
- JWT 기반 인증
- 비밀번호 bcrypt 해싱
- 로그인 시도 제한
- 관리자 전용 기능 권한 검증

**데이터 보호:**
- HTTPS 통신 (배포 시)
- 민감 정보 환경변수 관리 (.env 파일)
- SQL Injection 방지 (ORM 사용)

### 4.3 가용성 (Availability)

**에러 처리:**
- 파일 로깅 (로그 파일 저장)
- 에러 메시지 사용자 친화적 표시
- 장애 시 복구 메커니즘

**세션 관리:**
- 자동 세션 만료 처리
- 세션 만료 시 사용자 알림

### 4.4 유지보수성 (Maintainability)

**코드 품질:**
- 명확한 코드 구조
- 주석 및 문서화
- 테스트 코드 작성

**환경 설정:**
- .env 파일로 환경변수 관리
- 개발/프로덕션 환경 분리

### 4.5 사용성 (Usability)

**UI/UX:**
- 직관적인 인터페이스
- 터치 친화적 디자인 (태블릿 최적화)
- 반응형 레이아웃
- 명확한 피드백 메시지

---

## 5. 데이터 모델 개요

### 5.1 주요 엔티티

**Store (매장):**
- 매장 식별자
- 매장명
- 관리자 계정 정보

**Table (테이블):**
- 테이블 번호
- 테이블 비밀번호
- 현재 세션 ID
- 세션 시작 시각
- 마지막 주문 시각

**Menu (메뉴):**
- 메뉴 ID
- 메뉴명
- 가격
- 설명
- 카테고리
- 이미지 경로
- 노출 순서

**Order (주문):**
- 주문 ID
- 테이블 ID
- 세션 ID
- 주문 시각
- 주문 상태 (대기중/준비중/완료)
- 총 금액

**OrderItem (주문 항목):**
- 주문 ID
- 메뉴 ID
- 수량
- 단가

**OrderHistory (주문 이력):**
- 주문 ID
- 세션 ID
- 완료 시각
- 주문 데이터 (JSON)

---

## 6. MVP 개발 범위

### 핵심 기능 (필수)

**고객용:**
- ✅ 테이블 태블릿 자동 로그인 및 세션 관리
- ✅ 메뉴 조회
- ✅ 장바구니 관리
- ✅ 주문 생성
- ✅ 주문 내역 조회 (현재 세션만)

**관리자용:**
- ✅ 매장 인증 (16시간 세션)
- ✅ 실시간 주문 모니터링 (그리드 레이아웃, SSE)
- ✅ 테이블 관리 (초기 설정, 주문 삭제, 매장 이용 완료, 과거 내역 조회)
- ✅ 메뉴 관리 (CRUD)

---

## 7. 제외 기능 (Out of Scope)

### 7.1 결제 관련
- 실제 결제 처리 (카드, 현금, 디지털 지갑)
- 결제 게이트웨이 연동 (PG사 연동)
- 영수증 발행 및 출력
- 환불 처리
- 포인트/쿠폰 시스템

### 7.2 인증 및 보안
- 복잡한 사용자 인증 (OAuth, SNS 로그인)
- 다단계 인증 (2FA, OTP)

### 7.3 파일 및 컨텐츠 관리
- 이미지 리사이징/최적화
- 컨텐츠 관리 시스템
- 광고 기능

### 7.4 알림 시스템
- 푸시 알림 (모바일, 브라우저)
- SMS 알림
- 이메일 발송
- 소리/진동 알림

### 7.5 주방 기능
- 주문 내역 주방 전달
- 주방 식재료 재고 관리

### 7.6 고급 기능
- 데이터 분석 및 대시보드
- 매출 리포트 생성
- 재고 관리 시스템
- 직원 관리 및 권한 설정
- 예약 시스템
- 고객 리뷰 시스템
- 다국어 기능

### 7.7 외부 연동
- 배달 플랫폼 연동
- POS 시스템 연동
- 소셜 미디어 공유
- 지도 API
- 번역 API

---

## 8. 용어 정의

- **MVP**: Minimum Viable Product (최소 기능 제품)
- **API**: Application Programming Interface
- **UI/UX**: User Interface / User Experience
- **JWT**: JSON Web Token (인증 토큰)
- **SSE**: Server-Sent Events (서버 푸시 기술)
- **테이블 세션**: 특정 테이블에 고객이 앉아서 첫 주문 시작 후부터 해당 테이블 이용 완료 처리까지의 시간. 세션 종료 후 다른 고객의 첫 주문 시작 시, 새로운 세션 시작.
- **테이블 태블릿 로그인 세션**: 테이블 태블릿이 시스템에 로그인한 상태를 유지하는 시간 (16시간 고정)

---

## 9. 요구사항 추적성

본 요구사항 명세서는 다음 문서를 기반으로 작성되었습니다:
- `requirements/table-order-requirements.md` (원본 요구사항)
- `requirements/constraints.md` (제약사항)
- `aidlc-docs/inception/requirements/requirement-verification-questions.md` (기술 스택 결정)
- `aidlc-docs/inception/requirements/requirement-clarification-questions.md` (세부사항 명확화)

---

**문서 버전**: 1.0  
**작성일**: 2026-02-09  
**상태**: 승인 대기
